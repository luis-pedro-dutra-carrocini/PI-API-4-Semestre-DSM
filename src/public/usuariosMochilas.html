<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API - Mochilas Usu√°rio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
            color: #333;
        }

        h1,
        h2,
        h3 {
            color: #222;
        }

        .section {
            margin-bottom: 40px;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        pre {
            background: #eee;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }

        a {
            color: #0056b3;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .back-link {
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9em;
        }
    </style>
</head>

<body>
    <h1>üéí API - Mochilas Usu√°rio</h1>
    <p>Esta √© a documenta√ß√£o da API para a intera√ß√£o do usu√°rio com as mochilas. A maioria dos endpoints exige autentica√ß√£o de sess√£o do usu√°rio.</p>

    <div class="section" id="endpoints">
        <h2>üîó Endpoints</h2>
        <ul>
            <li><a href="index.html">Voltar ao Menu</a></li>
        </ul>
        <ul>
            <li><a href="#get-usuario">GET - /usuarios-mochilas/usuario/</a> - Obter mochilas do usu√°rio</li>
            <li><a href="#get-uso">GET - /usuarios-mochilas/mochilaUso/</a> - Obter mochila em uso pelo usu√°rio</li>
            <li><a href="#post-vincular">POST - /usuarios-mochilas/vincular/</a> - Vincular mochila a usu√°rio</li>
            <li><a href="#post-assumir-uso">POST - /usuarios-mochilas/assumir/</a> - Assumir uso de mochila</li>
            <li><a href="#post-encerrar-app">POST - /usuarios-mochilas/encerrarUsoApp/</a> - Encerrar uso via app</li>
            <li><a href="#post-encerrar-iot">POST - /\usuarios-mochilas/encerrarUsoIOT/</a> - Encerrar uso via IOT</li>
        </ul>
    </div>

    <div class="section" id="autenticacao">
        <h2>üîí Autentica√ß√£o</h2>
        <p>A maioria dos endpoints desta API requer autentica√ß√£o de sess√£o via <strong>JSON Web Token (JWT)</strong>. O token deve ser enviado no cabe√ßalho (header) da requisi√ß√£o, utilizando o esquema <code>Bearer</code>.</p>
        <h3>Exemplo de Header de Requisi√ß√£o:</h3>
        <pre>Authorization: Bearer &lt;seu_token_aqui&gt;</pre>
    </div>

    <div class="section" id="get-usuario">
        <h2>üì• GET - /usuarios-mochilas/usuario/</h2>
        <p>Obt√©m todas as mochilas vinculadas ao usu√°rio logado, com informa√ß√µes sobre o status de uso e per√≠odo. Requer <a href="#autenticacao">autentica√ß√£o</a>.</p>
        <h3>Corpo da requisi√ß√£o:</h3>
        <p>N√£o h√° corpo de requisi√ß√£o.</p>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um array de objetos com as mochilas do usu√°rio.
                <pre>[
    {
        "MochilaCodigo": "codigo",
        "MochilaDescricao": "Mochila de teste",
        "MochilaPesoMax": 10.5,
        "MochilaNome": "Mochila de Viagem",
        "UsoStatus": "N√£o Usando",
        "DataFimUso": null,
        "DataInicioUso": null
    },
    ...
]</pre>
            </li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`400 Bad Request`: `{ "error": "ID do usu√°rio inv√°lido" }`</li>
            <li>`400 Bad Request`: `{ "error": "Nenhuma mochila encontrada para o usu√°rio", mochila: 'Nenhuma' }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao obter mochilas" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="get-uso">
        <h2>üì• GET - /usuarios-mochilas/mochilaUso/</h2>
        <p>Obt√©m as mochila em que o usu√°rio logado est√° usando. Requer <a href="#autenticacao">autentica√ß√£o</a>.</p>
        <h3>Corpo da requisi√ß√£o:</h3>
        <p>N√£o h√° corpo de requisi√ß√£o.</p>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um JSON com a mochila em uso.
                <pre>
    {
        "MochilaCodigo": "codigo",
        "MochilaDescricao": "Mochila de teste",
        "MochilaPesoMax": 10.5,
        "MochilaNome": "Mochila de Viagem",
        "UsoStatus": "N√£o Usando",
        "DataFimUso": null,
        "DataInicioUso": null
    },
    </pre>
            </li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`400 Bad Request`: `{ "error": "ID do usu√°rio inv√°lido" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao obter mochilas" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="post-vincular">
        <h2>üîó POST - /usuarios-mochilas/vincular/</h2>
        <p>Vincula uma mochila existente ao usu√°rio logado, usando o c√≥digo da mochila e um apelido para identifica√ß√£o. Requer <a href="#autenticacao">autentica√ß√£o</a>.</p>
        <h3>Corpo da requisi√ß√£o:</h3>
        <pre>{
    "MochilaCodigo": "codigo",
    "MochilaNome": "Mochila do Trabalho"
}</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: `{ "ok": true, "message": "Mochila vinculada com sucesso" }`</li>
            <li>`400 Bad Request`: `{ "error": "C√≥digo da mochila √© obrigat√≥rio" }` ou `{ "error": "ID do usu√°rio inv√°lido" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Usu√°rio n√£o encontrado" }`</li>
            <li>`409 Conflict`: `{ "error": "Usu√°rio j√° est√° vinculado a esta mochila" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao vincular mochila" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="post-assumir-uso">
        <h2>‚ñ∂Ô∏è POST - /usuarios-mochilas/assumir/</h2>
        <p>Permite que o usu√°rio logado assuma o uso de uma mochila, alterando seu status para "Usando". Requer <a href="#autenticacao">autentica√ß√£o</a>.</p>
        <h3>Corpo da requisi√ß√£o:</h3>
        <pre>{
    "MochilaCodigo": "codigo"
}</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: `{ "ok": true, "message": "Mochila assumida com sucesso" }`</li>
            <li>`400 Bad Request`: `{ "error": "C√≥digo da mochila √© obrigat√≥rio" }` ou `{ "error": "ID do usu√°rio inv√°lido" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "V√≠nculo entre usu√°rio e mochila n√£o encontrado" }`</li>
            <li>`409 Conflict`: `{ "error": "J√° existe um usu√°rio usando esta mochila" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao assumir uso" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="post-encerrar-app">
        <h2>‚èπÔ∏è POST - /usuarios-mochilas/encerrarUsoApp/</h2>
        <p>Encerra o uso de uma mochila que est√° em status "Usando" ou "√öltimo a Usar" para o usu√°rio logado. Requer <a href="#autenticacao">autentica√ß√£o</a>.</p>
        <h3>Corpo da requisi√ß√£o:</h3>
        <pre>{
    "MochilaCodigo": "codigo"
}</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: `{ "ok": true, "message": "Uso encerrado com sucesso" }`</li>
            <li>`400 Bad Request`: `{ "error": "C√≥digo da mochila √© obrigat√≥rio" }` ou `{ "error": "ID do usu√°rio inv√°lido" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Usu√°rio n√£o encontrado" }`</li>
            <li>`409 Conflict`: `{ "error": "Nenhum uso ativo encontrado para encerrar" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao encerrar uso" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="post-encerrar-iot">    
        <h2>üîå POST - /\usuarios-mochilas/encerrarUsoIOT/</h2>
        <p>Encerra o uso de uma mochila por meio do dispositivo IoT, alterando o status para "√öltimo a Usar". Requer autentica√ß√£o espec√≠fica da mochila (IoT), que √© enviada via token no cabe√ßalho da requisi√ß√£o. Requer tamb√©m <a href="#autenticacao">autentica√ß√£o</a> por√©m da IoT, que segue a mesma estrutura do JWT.</p>
        <h3>Corpo da requisi√ß√£o:</h3>
        <p>N√£o h√° corpo de requisi√ß√£o, a autentica√ß√£o √© feita via token JWT da mochila.</p>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: `{ "ok": true, "message": "Uso encerrado com sucesso" }`</li>
            <li>`400 Bad Request`: `{ "error": "ID da mochila inv√°lido" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Mochila n√£o autenticada" }`</li>
            <li>`403 Forbidden`: `{ "error": "Acesso negado. Token inv√°lido para mochila." }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }`</li>
            <li>`409 Conflict`: `{ "error": "Nenhum uso ativo encontrado para encerrar" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao encerrar uso" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>
</body>

</html>