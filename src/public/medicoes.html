<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API - Medi√ß√µes & Relat√≥rios</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
            color: #333;
        }

        h1,
        h2,
        h3 {
            color: #222;
        }

        .section {
            margin-bottom: 40px;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        pre {
            background: #eee;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }

        a {
            color: #0056b3;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .back-link {
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .auth-info {
            background-color: #e6f7ff;
            border-left: 4px solid #3399ff;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .auth-info h4 {
            margin-top: 0;
            margin-bottom: 5px;
        }

        .auth-info code {
            background-color: #d6eaf8;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>

<body>
    <h1>üìä API - Medi√ß√µes & Relat√≥rios</h1>
    <p>Esta √© a documenta√ß√£o da API para o registro de medi√ß√µes e a obten√ß√£o de relat√≥rios de uso das mochilas. As
        rotas de relat√≥rios exigem autentica√ß√£o de usu√°rio via token JWT.</p>

    <div class="section" id="endpoints">
        <h2>üîó Endpoints</h2>
        <ul>
            <li><a href="index.html">Voltar ao Menu</a></li>
        </ul>
        <ul>
            <li><a href="#post-criar-medicao">POST /medicoes/criar</a> - Criar medi√ß√£o (requer token de mochila)</li>
            <li><a href="#get-relatorio-semanal">GET /medicoes/relatorio/semanal/:mochila</a> - Relat√≥rio semanal</li>
            <li><a href="#get-relatorio-mensal">GET /medicoes/relatorio/mensal/:mochila/:ano/:mes</a> - Relat√≥rio mensal
            </li>
            <li><a href="#get-relatorio-anual">GET /medicoes/relatorio/anual/:mochila/:ano</a> - Relat√≥rio anual</li>
            <li><a href="#get-relatorio-dia">GET /medicoes/relatorio/dia/:mochila/:data</a> - Relat√≥rio di√°rio</li>
            <li><a href="#get-relatorio-peso">GET /medicoes/relatorio/peso/:mochila</a> - Dia com mais e menos peso</li>
            <li><a href="#get-relatorio-periodo">GET /medicoes/relatorio/periodo/:mochila/:inicio/:fim</a> - Relat√≥rio
                por per√≠odo</li>
        </ul>
    </div>

    <div class="section" id="autenticacao">
        <h2>üîí Autentica√ß√£o</h2>
        <p>A maioria dos endpoints desta API requer autentica√ß√£o de sess√£o via <strong>JSON Web Token (JWT)</strong>. O
            token deve ser enviado no cabe√ßalho (header) da requisi√ß√£o, utilizando o esquema <code>Bearer</code>.</p>
        <h3>Exemplo de Header de Requisi√ß√£o:</h3>
        <pre>Authorization: Bearer &lt;seu_token_aqui&gt;</pre>
    </div>

    <div class="section" id="post-criar-medicao">
        <h2>üìù POST /medicoes/criar</h2>
        <p>Registra uma nova medi√ß√£o de peso para uma mochila espec√≠fica, geralmente enviada por um dispositivo IoT. A valida√ß√£o inclui o status de uso da mochila e o limite de peso do usu√°rio.</p>
        <h3>Corpo da requisi√ß√£o:</h3>
        <pre>{
    "MedicaoPeso": 12.5,
    "MedicaoLocal": "centro"
}</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`201 Created`: `{ "ok": true, "message": "Medi√ß√£o registrada com sucesso" }`</li>
            <li>`400 Bad Request`: `{ "error": "Peso √© obrigat√≥rio" }`, `{ "error": "Local √© obrigat√≥rio" }`, etc.</li>
            <li>`401 Unauthorized`: `{ "error": "Mochila n√£o autenticada" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }`, `{ "error": "Nenhum usu√°rio ativo para esta
                mochila" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao registrar medi√ß√£o" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="get-relatorio-semanal">
        <h2>üóìÔ∏è GET /medicoes/relatorio/semanal/:mochila</h2>
        <p>Retorna todas as medi√ß√µes registradas para uma mochila espec√≠fica nos √∫ltimos 7 dias. Requer autentica√ß√£o de sess√£o do usu√°rio.</p>
        <h3>Par√¢metros de URL:</h3>
        <pre>/medicoes/relatorio/semanal/mochila_codigo_exemplo</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um array de objetos de medi√ß√£o.
                <pre>[
    {
        "MedicaoPeso": 10.5,
        "MedicaoData": "2025-09-06T15:30:00.000Z",
        "MedicaoStatus": "Dentro do limite",
        "MedicaoLocal": "ambos",
        "MedicaoPesoMaximoPorcentagem": 85.2,
        "MedicaoPesoMais": 1.5
    },
    ...
]</pre>
            </li>
            <li>`400 Bad Request`: `{ "error": "ID do usu√°rio inv√°lido" }` ou `{ "error": "Informe o c√≥digo da mochila" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Nenhuma medi√ß√£o encontrada nos √∫ltimos 7 dias" }` ou `{ "error": "Usu√°rio n√£o est√° vinculado a esta mochila" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao buscar relat√≥rio semanal" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="get-relatorio-mensal">
        <h2>üìÖ GET /medicoes/relatorio/mensal/:mochila/:ano/:mes</h2>
        <p>Retorna todas as medi√ß√µes registradas para uma mochila em um m√™s e ano espec√≠ficos. Requer autentica√ß√£o de sess√£o do usu√°rio.</p>
        <h3>Par√¢metros de URL:</h3>
        <pre>/medicoes/relatorio/mensal/mochila_codigo_exemplo/2025/08</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um array de medi√ß√µes do m√™s.</li>
            <li>`400 Bad Request`: `{ "error": "Informe m√™s e ano" }` ou `{ "error": "ID do usu√°rio inv√°lido" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Nenhuma medi√ß√£o encontrada no
                m√™s informado" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao buscar relat√≥rio mensal" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="get-relatorio-anual">
        <h2>üìà GET /medicoes/relatorio/anual/:mochila/:ano</h2>
        <p>Retorna todas as medi√ß√µes registradas para uma mochila em um ano espec√≠fico. Requer autentica√ß√£o de sess√£o do usu√°rio.</p>
        <h3>Par√¢metros de URL:</h3>
        <pre>/medicoes/relatorio/anual/mochila_codigo_exemplo/2025</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um array de medi√ß√µes do ano.</li>
            <li>`400 Bad Request`: `{ "error": "Informe o ano" }` ou `{ "error": "Ano inv√°lido" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Nenhuma medi√ß√£o encontrada no
                ano informado" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao buscar relat√≥rio anual" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="get-relatorio-dia">
        <h2>‚òÄÔ∏è GET /medicoes/relatorio/dia/:mochila/:data</h2>
        <p>Retorna todas as medi√ß√µes registradas para uma mochila em um dia espec√≠fico. Requer autentica√ß√£o de sess√£o do usu√°rio.</p>
        <h3>Par√¢metros de URL:</h3>
        <pre>/medicoes/relatorio/dia/mochila_codigo_exemplo/2025-08-10</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um array de medi√ß√µes do dia.</li>
            <li>`400 Bad Request`: `{ "error": "Informe a data" }` ou `{ "error": "Data inv√°lida" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Nenhuma medi√ß√£o encontrada no
                dia informado" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao buscar relat√≥rio di√°rio" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="get-relatorio-peso">
        <h2>‚öñÔ∏è GET /medicoes/relatorio/peso/:mochila</h2>
        <p>Encontra o dia com o maior e o menor peso registrado para uma mochila. Requer autentica√ß√£o de sess√£o do usu√°rio.</p>
        <h3>Par√¢metros de URL:</h3>
        <pre>/medicoes/relatorio/peso/mochila_codigo_exemplo</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um objeto com os dados da medi√ß√£o de maior e menor peso.
                <pre>{
    "ok": true,
    "maisPeso": { ... },
    "menosPeso": { ... }
}</pre>
            </li>
            <li>`400 Bad Request`: `{ "error": "ID do usu√°rio inv√°lido" }` ou `{ "error": "Informe o c√≥digo da mochila" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Nenhuma medi√ß√£o encontrada" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao buscar dia mais/menos peso" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>

    <div class="section" id="get-relatorio-periodo">
        <h2>üï∞Ô∏è GET /medicoes/relatorio/periodo/:mochila/:inicio/:fim</h2>
        <p>Retorna todas as medi√ß√µes para uma mochila dentro de um intervalo de datas informado. Requer autentica√ß√£o de sess√£o do usu√°rio.</p>
        <h3>Par√¢metros de URL:</h3>
        <pre>/medicoes/relatorio/periodo/mochila_codigo_exemplo/2025-08-01/2025-08-15</pre>
        <h3>Respostas:</h3>
        <ul>
            <li>`200 OK`: Retorna um array de medi√ß√µes do per√≠odo.</li>
            <li>`400 Bad Request`: `{ "error": "Datas de in√≠cio e fim s√£o obrigat√≥rias (formato: YYYY-MM-DD)" }` ou `{ "error": "Datas inv√°lidas" }`</li>
            <li>`401 Unauthorized`: `{ "error": "Usu√°rio n√£o autenticado" }`</li>
            <li>`403 Forbidden`: `{ "error": "Token inv√°lido para usu√°rio" }`</li>
            <li>`404 Not Found`: `{ "error": "Mochila n√£o encontrada" }` ou `{ "error": "Nenhuma medi√ß√£o encontrada
                nesse per√≠odo" }`</li>
            <li>`500 Internal Server Error`: `{ "error": "Erro ao buscar medi√ß√µes por per√≠odo" }`</li>
        </ul>
        <a href="#endpoints" class="back-link">‚¨Ö Voltar para Endpoints</a>
    </div>
</body>

</html>